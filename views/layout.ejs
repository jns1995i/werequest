<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || "BVRSRS" %></title>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;500;600;700&display=swap">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

    <link rel="stylesheet" href="/style.css">
    <link rel="icon" href="/images/logo.png">

    <style>
        .active {
            font-weight: bold;
        }
        .nav2 {
            padding: 8px;
            border-radius: 12px;
        }
        .nav2.mnav:hover {
            transform: scale(1) !important;
        }
        #subNav, #subMenu {
            margin-left: 10px;
            padding-left: 5px;
            padding-top: 5px;
            padding-bottom: 0;
            background: linear-gradient(to right, white 1px, transparent 1px);
        }
        .lg1:hover {
            transform: scale(1);
        }
    </style>
</head>
<body class="">
<div class="col relative">
    <div class="height10" style="opacity: 0;"></div>
    <div class="height10 headPrime gap5 padding10 justifyBetween absolute left0 top0 index50 darkShadow">
            <div class="height0 width13 padding10">
                <div class="justifyCenter borderRadius10 width0"  style="border: 0.5px solid rgba(230, 230, 230, 0.3);">
                    <div class="logo">
                        <img src="/images/logo.png" class="h50 w50" style="border: 0.5px solid white;">
                    </div>
                    <div class="logoLabel white col paddingRight10">
                        <p class="size18 str400">WeRequest</p>
                    </div>
                </div>
            </div>
            <div class="menu white width0" style="height: 100%; padding: 0;">
                <div class="gap5 width0" style="height: 75px !important; justify-content: end; z-index: 50 !important;">
                    <div class="height0 col width0 alignEnd">
                            <p class="size12 str300">Welcome <%= user.position %></p>
                            <p class="size18 str400"><%= user.firstName %> <%= user.lastName %></p>
                    </div>
                    <div class="logo h70 w70">
                        <a href="/resv/<%= user._id %>" id="prf" style="border: 1px solid white; border-radius: 50%; padding: 5px; background-color: transparent">
                            <img src="<%= user.photo ? user.photo : "/images/profile.jpg" %>" alt="Profile Image" onerror="this.onerror=null; this.src='/images/profile.jpg';" class="h70 w70">
                        </a>
                    </div>
                </div>
            </div>

    </div>
    <div class="height90">
        <div class="sidef relative">
            <div class="menu justifyEnd hidden" style="height: 10%; padding: 0;">
                <div class="borderRadius15 gap5" style="height: 65px !important; justify-content: start; z-index: 50 !important;">
                    <div class="logo">
                        <a href="/resv/<%= user._id %>" id="prf" style="border: 1px solid white; border-radius: 50%; padding: 5px; background-color: transparent">
                            <img src="<%= user.photo ? user.photo : "/images/profile.jpg" %>" alt="Profile Image" onerror="this.onerror=null; this.src='/images/profile.jpg';">
                        </a>
                    </div>
                    <div class="height0 col width0 alignStart">
                            <p class="size14 str400">Hello <%= user.firstName %></p>
                            <p class="size12 str300"><%= user.position %></p>
                    </div>
                </div>
            </div>

            <div class="menu height100 relative">
                <a href="/" class="nav mnav absolute left0 bottom5 width99 lg1 justifyCenter <%= activePage === 'das' ? 'active' : '' %>" style="border: 0.5px solid gray;"><i class="fas fa-share-from-square" style="margin-left: 0;"></i> Logout</a>
                <p class="size14 opacity9">MENU</p>
                <hr>
                <a href="/das" class="nav mnav <%= activePage === 'das' ? 'active' : '' %>"><i class="fas fa-home"></i> Dashboard</a>
                <a href="/docc" class="nav mnav <%= activePage === 'docc' ? 'active' : '' %>"><i class="fas fa-file-lines"></i> Document</a>
                <a href="/res" class="nav mnav <%= activePage === 'res' ? 'active' : '' %>"><i class="fas fa-users"></i> Resident</a>
                <a href="/bss" class="nav mnav <%= activePage === 'bss' ? 'active' : '' %>"><i class="fas fa-building"></i> Business</a>
                <a href="/blot" class="nav mnav <%= activePage === 'blot' ? 'active' : '' %>"><i class="fas fa-exclamation-triangle"></i> Blotter</a>
                <a href="/ann" class="nav mnav <%= activePage === 'ann' ? 'active' : '' %>"><i class="fas fa-bullhorn"></i> Announcement</a>
                <a href="/ver" class="nav mnav <%= activePage === 'ver' ? 'active' : '' %>"><i class="fas fa-user-circle"></i> Accounts</a>
            </div>
            
            <div class="headf justifyCenter borderRadius10 width90 bgWhite hidden"  style="border: 0.5px solid rgba(255, 255, 255, 0.3);">
                <div class="logo bgWhite">
                    <img src="/images/logo.png" class="h50 w50" style="border: 0.5px solid white;">
                </div>
                <div class="logoLabel colorPrimary col paddingRight10">
                    <p class="size18 str500">WeRequest</p>
                </div>
            </div>
        </div>

        <div class="mainf">
            <%- body %>
        </div>
    </div>
</div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let menu = document.getElementById("menu");
            let subMenu = document.getElementById("subMenu");
            let nav = document.getElementById("nav");
            let subNav = document.getElementById("subNav");
            let menuChevron = menu.querySelector("i.fas.fa-chevron-down"); 
            let navChevron = nav.querySelector("i.fas.fa-chevron-down"); 
    
            function closeAll() {
                subMenu.classList.add("hidden");
                subNav.classList.add("hidden");
                menuChevron.style.transform = "rotate(0deg)";
                navChevron.style.transform = "rotate(0deg)";
            }
    
            menu.addEventListener("click", function (event) {
                event.preventDefault();
                let isMenuOpen = !subMenu.classList.contains("hidden");
    
                closeAll(); // Close both first
                if (!isMenuOpen) {
                    subMenu.classList.remove("hidden");
                    subMenu.classList.add("padding15");
                    menuChevron.style.transition = "transform 0.3s ease";
                    menuChevron.style.transform = "rotate(180deg)";
                }
                event.stopPropagation();
            });
    
            nav.addEventListener("click", function (event) {
                event.preventDefault();
                let isNavOpen = !subNav.classList.contains("hidden");
    
                closeAll(); // Close both first
                if (!isNavOpen) {
                    subNav.classList.remove("hidden");
                    subNav.classList.add("padding15");
                    navChevron.style.transition = "transform 0.3s ease";
                    navChevron.style.transform = "rotate(180deg)";
                }
                event.stopPropagation();
            });
    
            document.addEventListener("click", function (event) {
                if (!menu.contains(event.target) && !subMenu.contains(event.target) &&
                    !nav.contains(event.target) && !subNav.contains(event.target)) {
                    closeAll();
                }
            });
    
            subMenu.addEventListener("click", function (event) {
                event.stopPropagation();
            });
    
            subNav.addEventListener("click", function (event) {
                event.stopPropagation();
            });
        });
    </script>
    <script>document.addEventListener("DOMContentLoaded", function () {
        let residentsMenu = document.getElementById("xtr");
        let residentsSubMenu = document.getElementById("xtrDiv");
        let residentsChevron = residentsMenu.querySelector("i.fas.fa-chevron-down");
    
        function closeResidentsMenu() {
            residentsSubMenu.classList.add("hidden");
            residentsChevron.style.transform = "rotate(0deg)";
        }
    
        residentsMenu.addEventListener("click", function (event) {
            event.preventDefault();
            let isMenuOpen = !residentsSubMenu.classList.contains("hidden");
    
            closeResidentsMenu(); // Close first before toggling
            if (!isMenuOpen) {
                residentsSubMenu.classList.remove("hidden");
                residentsChevron.style.transition = "transform 0.3s ease";
                residentsChevron.style.transform = "rotate(180deg)";
            }
            event.stopPropagation();
        });
    
        document.addEventListener("click", function (event) {
            if (!residentsMenu.contains(event.target) && !residentsSubMenu.contains(event.target)) {
                closeResidentsMenu();
            }
        });
    
        residentsSubMenu.addEventListener("click", function (event) {
            event.stopPropagation();
        });
    });
    
    </script>
</body>
</html>
